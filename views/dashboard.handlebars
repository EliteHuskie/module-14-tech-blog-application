{{#if logged_in}}
    <div class="mt-4">
        <h3>{{user.name}}'s Dashboard</h3>

        <!-- New post creation form toggle -->
        <button id="toggle-form-button" class="btn btn-primary mt-3">Create New Post</button>

        <!-- New post creation form -->
        <div id="create-post-form-container" class="new-post-form mt-3" style="display: none;">
            <h4>Create New Post</h4>
            <form id="create-post-form" class="form new-post-form">
                <div class="mb-3">
                    <label for="title" class="form-label">Title:</label>
                    <input class="form-control" type="text" id="title" name="title">
                </div>
                <div class="mb-3">
                    <label for="content" class="form-label">Content:</label>
                    <textarea class="form-control" rows="3" id="content" name="content"></textarea>
                </div>
                <button class="btn btn-primary" type="submit">Create Post</button>
            </form>
        </div>

        <!-- Display existing posts -->
        <div class="existing-posts mt-4">
            <h4>Your Existing Posts</h4>
            {{#each user.Posts}}
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">{{title}}</h5>
                        <div class="post-content">
                            <p class="card-text">{{contents}}</p>
                            <p class="card-text">{{format_date date_created}}</p>
                        </div>
                        <button class="btn btn-primary edit-post" data-post-id="{{id}}">Edit</button>
                        <button class="btn btn-danger delete-post" data-post-id="{{id}}">Delete</button>
                        <div class="edit-form" style="display: none;">
                            <form class="edit-form" data-post-id="{{id}}">
                                <div class="mb-3">
                                    <label for="edit-title">Title:</label>
                                    <input type="text" class="form-control" id="edit-title" value="{{title}}">
                                </div>
                                <div class="mb-3">
                                    <label for="edit-content">Content:</label>
                                    <textarea class="form-control" id="edit-content" rows="3">{{contents}}</textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                                <button type="button" class="btn btn-secondary cancel-edit">Cancel</button>
                            </form>
                        </div>
                    </div>
                </div>
            {{/each}}
        </div>
    </div>
{{/if}}

<!-- Include the script for handling new post creation and deletion -->
<script src="./js/createpost.js"></script>
<script src="./js/editpost.js"></script>
<script src="./js/deletepost.js"></script>
